# Key Overlay (Windows)

一个用于 Windows 的键盘按键显示与录制/回放的小工具，基于 PySide6。包含“显示面板”（透明 HUD）与“控制面板”（简约游戏风/微信风标题栏），支持置顶、拖拽、调整大小、录制保存与选择播放等功能。

## 功能特性
- 按键显示：透明背景 + 半透明灰黑色长条背景，大号字体展示当前按下的组合（如 `A+S`）。
- 显示面板：可隐藏/显示、可拖拽、可在右下角拖拽调整大小、可选择屏幕四角位置。
- 控制面板：最小化/关闭按钮、自定义标题栏、100×50 紧凑按钮、支持“📌置顶”同时置顶控制面板和显示面板。
- 录制：开始/停止录制，停止时可选择保存到默认路径或自定义路径（默认路径：`%USERPROFILE%\.key_overlay\last_record.json`）。
- 回放：可播放最近一次录制，或从文件选择任意录制文件进行播放。
- 托盘菜单：显示/隐藏显示面板、位置（四角）、开始/停止录制、播放最近、退出。

## 环境要求
- Windows 10 或更高版本
- Python 3.10+

## 安装
```powershell
cd key-overlay
pip install -r requirements.txt
```

部分系统下，`keyboard` 库需要以管理员权限运行终端后再启动程序，才能正常监视/回放全局键盘事件。

## 运行
```powershell
python app.py
```

启动后会看到两个窗口：
- 控制面板：包含“开始/停止监视”“开始/停止录制”“播放最近”“选择播放”“显示/隐藏显示面板”以及标题栏右侧的“📌置顶 / — 最小化 / × 关闭”。
- 显示面板：半透明长条 HUD，用于展示当前按键组合。可拖拽移动，右下角可拉伸调整大小。

## 使用说明
- 监视：点击“开始监视”以开启全局键盘监视；停止监视会清空显示。
- 录制：点击“开始录制”开始记录；点击“停止录制”时会弹出保存选择：
  - 保存到默认路径：`%USERPROFILE%\.key_overlay\last_record.json`
  - 选择保存位置：保存到你指定的 `.json` 文件
  - 取消：默认仍会保存到默认路径，避免误丢失
- 播放：
  - “播放最近”从默认路径加载并回放最近一次录制
  - “选择播放”从文件选择任意录制文件进行回放
- 置顶：点击标题栏“📌”可将控制面板与显示面板同时保持最前。
- 托盘：右下角托盘图标提供相同的控制项与位置切换（四角）。

## 常见问题
- 没有显示或无法监视/回放：尝试以管理员身份运行终端后再启动程序。
- 回放会向系统发送按键事件，请在安全环境中测试，避免影响到重要窗口或输入框。

## 目录结构（简要）
```
key-overlay/
  app.py               # 主程序
  requirements.txt     # 依赖
  README.md            # 说明文档
```

## License
MIT（可按需修改）。

